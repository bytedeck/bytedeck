{% extends "flatpages/base.html" %}
{% load crispy_forms_tags %}

{% block head_title%}{{ flatpage.title }} | {% endblock%}

{% block content %}
  <div class="pull-right">
  {% if  request.user.is_staff %}

  {% endif %}
  </div>
  <h1>{{ flatpage.title }}
    <i class="pull-right fa fa-file-text-o"></i>
    {% if user.is_staff %}
    <a class="btn btn-info btn-sm" href="{% url 'utilities:flatpage-edit' pk=flatpage.pk %}" role="button"
      title = "Edit this page" >
      <i class="fa fa-edit"></i></a>
    {% endif %}
  </h1>
  {{ flatpage.content|safe }}
{% endblock %}

{% block js %}
  <script>

    var ToC =
      "<nav role='navigation' class='table-of-contents'>" +
        "<h4>Contents:</h4>" +
        "<ul>";

    $("#main h3").each(function() {

        var $el = $(this);
        var title = $el.text();
        $el.attr("id", title);

        var tocEntry =
            "<li>" +
            "<a href='#" + title + "'>" +
            title +
            "</a>" +
            "</li>";

        ToC += tocEntry;

    });


    ToC +=
        "</ul>" +
        "</nav>";

    $("#TOC").append(ToC);

  </script>


{% endblock %}